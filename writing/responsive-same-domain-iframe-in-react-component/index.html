<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/app.a2f933b7ab5f58f2ecfb.css">code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.0.76"/><link rel="shortcut icon" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/favicon-32x32.png"/><link rel="manifest" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/manifest.json"/><meta name="mobile-web-app-capable" content="yes"/><meta name="theme-color" content="#fff"/><meta name="application-name" content="personal_website_2019"/><link rel="apple-touch-icon" sizes="57x57" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-180x180.png"/><link rel="apple-touch-icon" sizes="1024x1024" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-icon-1024x1024.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/><meta name="apple-mobile-web-app-title" content="personal_website_2019"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-320x460.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-640x920.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-640x1096.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-750x1294.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 3)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-1182x2208.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 3)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-1242x2148.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-748x1024.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-768x1004.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-1496x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" href="/icons-2fb150dc2c43ba7bfab0a2d44ec3f9a1/apple-touch-startup-image-1536x2008.png"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45 'Source Sans Pro',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Source Sans Pro',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:2.9rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:2.175rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.1487rem;line-height:1.45rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.45rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:'Merriweather',serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.917rem;line-height:1.45rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:Source Sans Pro,sans-serif;font-weight:400;text-rendering:optimizeLegibility;font-size:0.8409rem;line-height:1.45rem;text-transform:uppercase;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}ul{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:0.85rem;line-height:1.45rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}blockquote{margin-left:1.45rem;margin-right:1.45rem;margin-top:0;padding-bottom:0.48333rem;padding-left:0.96667rem;padding-right:0.96667rem;padding-top:0.48333rem;margin-bottom:1.45rem;font-size:1.18921rem;line-height:1.45rem;border-left:0.24167rem solid;border-color:#eaeaeb;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.45rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.45rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}li > ul{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.45rem / 2);}code{font-size:0.85rem;line-height:1.45rem;}kbd{font-size:0.85rem;line-height:1.45rem;}samp{font-size:0.85rem;line-height:1.45rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:0.96667rem;padding-right:0.96667rem;padding-top:0.725rem;padding-bottom:calc(0.725rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#0c2461;}a:visited{color:#0c2461;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.45rem;color:#eaeaeb;font-weight:400;font-style:normal;}</style><link href="//fonts.googleapis.com/css?family=Libre+Barcode+128+Text:|Merriweather:700|Source+Sans+Pro:400,400i,700" rel="stylesheet" type="text/css"/><style data-styled="bYBvlf ksbQrc jzPAjz gHfQcS drYZet jGolJI jJkEdO" data-styled-version="4.1.3">
/* sc-component-id: layout__Header-sc-12oumoz-0 */
.bYBvlf{border-bottom:1px solid #eaeaeb;text-align:right;line-height:70px;}
/* sc-component-id: layout__LinkHome-sc-12oumoz-1 */
.ksbQrc{float:left;text-shadow:none;background-image:none;-webkit-text-decoration:none;text-decoration:none;margin:0 0 0 30px;}
/* sc-component-id: layout__Logo-sc-12oumoz-2 */
.jzPAjz{display:"inline-block";color:#e55039;margin:0;vertical-align:"middle";font-family:'Libre Barcode 128 Text',Arial,Helvetica,sans-serif;font-size:52px;}
/* sc-component-id: layout__Hamburger-sc-12oumoz-3 */
.gHfQcS{margin:0 40px 0 0;font-size:26px;line-height:70px;display:none;color:#e55039;} @media (max-width:37.4375em){.gHfQcS{display:inline-block;cursor:pointer;}}
/* sc-component-id: layout__Menu-sc-12oumoz-4 */
.drYZet{margin:0 30px 0 0;} @media (max-width:37.4375em){.drYZet{text-align:center;width:100%;display:none;}}
/* sc-component-id: layout__MenuLink-sc-12oumoz-5 */
.jGolJI{-webkit-text-decoration:none;text-decoration:none;margin:0 10px;line-height:70px;} @media (max-width:37.4375em){.jGolJI{display:block;border-top:1px solid #eaeaeb;margin:0;}}
/* sc-component-id: layout__Container-sc-12oumoz-6 */
.jJkEdO{margin:0 auto;max-width:650px;padding:1rem 1rem 0 1rem;}</style><title data-react-helmet="true">Simon Gawlik</title><meta data-react-helmet="true" charSet="utf-8"/><meta data-react-helmet="true" name="description" content="Simon Gawlik Personal Website Home"/><link as="script" rel="preload" href="/component---src-templates-writing-js-44da32ae3be64ba2449b.js"/><link as="script" rel="preload" href="/0-9ac6a65bd5e612ec4a71.js"/><link as="script" rel="preload" href="/app-61613bc7b701c1af75b4.js"/><link as="script" rel="preload" href="/webpack-runtime-d9e994a04b02e9bd7f23.js"/><link as="fetch" rel="preload" href="/static/d/559/path---writing-responsive-same-domain-iframe-in-react-component-045-348-HcXUmWgTjrOlJaBRDDSKMB1e0.json" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div><div class="layout__Header-sc-12oumoz-0 bYBvlf"><a class="layout__LinkHome-sc-12oumoz-1 ksbQrc" href="/"><div class="layout__Logo-sc-12oumoz-2 jzPAjz">SimonGAWLIK</div></a><div class="layout__Hamburger-sc-12oumoz-3 gHfQcS">☰</div><div class="layout__Menu-sc-12oumoz-4 drYZet"><a class="layout__MenuLink-sc-12oumoz-5 jGolJI" href="/about/">About</a><a class="layout__MenuLink-sc-12oumoz-5 jGolJI" href="/writing">Writing</a></div></div><div class="layout__Container-sc-12oumoz-6 jJkEdO"><div><h1>Responsive Same-Domain Iframe in React Component</h1><div><h2>Why you may want it</h2>
<p>Recently, we needed to embed a number of personal finance calculators in
our customer-facing portal. Instead of building very elaborate models for the
calculators and spending a lot of time on implementing each one of them from
scratch, we wanted to see which calculators users would find most interesting.
Iteration speed and testing users' interactions with many calculators and
underlying models was more important than building a perfect calculator or
having the outputs persisted in the backend.</p>
<p>Based on these requirements, we decided to look for tools that would help the
buisness team create calculators easily and quickly and keep developers focused
on more pressing development tasks. We found a website that converts
spreadsheets with formulas into responsive and dynamic forms that can also display
results. Lastly, the site also allows us to download the forms as html files. And
all of it for free (<em>which is always good for a startup</em>)!</p>
<p>Instead of just rendering these files individually, we wanted to make them
feel like they were native to our app and surround them with the proper
context and branding. They couldn't just look like iframes clumsily thrown onto
the page. That
meant no double scrolling in this case (where you have a scrollbar on the browser
window and another one on a particular iframe or div in the DOM).
That's not so easy when the forms themselves would get longer or shorter in the
iframe based on the user toggling a switch or changing an answer. Also, different
calculators have different lengths in their iframes. Thus, no hardcoding allowed
because we wanted to reuse the pages and components wrapping those calculators.</p>
<p>You may use the following techniques if</p>
<ol>
<li>You're using React (though similar things may work for other frontend frameworks)</li>
<li>You don't need to render server-side</li>
<li>You have an html file, a relative path to your own domain, or a url
to a domain with cross-origin checking turned off.</li>
</ol>
<p>One last word of caution. Be careful which html files or urls you include,
otherwise you may expose your users to XSS.</p>
<p>Ok, so far so motivated...</p>
<h2>How you do it</h2>
<p>If you want to dive right into the code and see the working example without much
further ado, then click <a href="https://codepen.io/simongawlik/pen/zyJbMm">here</a>.</p>
<iframe style="width:100%;" height="300" src="https://codepen.io/simongawlik/full/zyJbMm" frameborder="1" allowfullscreen></iframe>
<p>If you've read past this point, then I'll provide some context to the code now.</p>
<p>The difficulty is that React's virtual DOM needs to work with the actual
DOM. Some elements like the <code class="language-text">iframe</code>'s content may load after the virtual
DOM has already mounted the components. Or a user may drag the side of the browser and that
could change the height of the <code class="language-text">iframe</code>'s content. What we need is for the
component to be told what the height of the iframe's content wants to be and
when that changes. The component could then pass down that height to the
components that wrap the <code class="language-text">iframe</code>.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> iframeHeight<span class="token punctuation">:</span> undefined <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>You can see that my <code class="language-text">App</code> component has only one variable in its state,
<code class="language-text">iframeHeight</code>. We use will use it to set the height of the elements that contain
the <code class="language-text">iframe</code>.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkIfIframeLoaded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">checkIfIframeLoaded</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'responsive-iframe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> iframeDoc <span class="token operator">=</span> iframe<span class="token punctuation">.</span>contentDocument <span class="token operator">||</span>
      iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>document<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>iframeDoc<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">'complete'</span> <span class="token operator">&amp;&amp;</span>
        iframeDoc<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onElementHeightChange</span><span class="token punctuation">(</span>iframe<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>updateIframeHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>checkIfIframeLoaded<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>As soon as the component is done mounting, we check if our particular iframe
exists in the DOM yet. We use the DOM API to see if we can find an <code class="language-text">iframe</code> with
a particular <code class="language-text">id</code>, in this case <code class="language-text">&#39;responsive-iframe&#39;</code>, and whether the
document inside of it is done loading and
contains a <code class="language-text">body</code> tag. If it does, we can get the height of the body and update
<code class="language-text">iframeHeight</code>. If not, we wait for 0.1 seconds and try again.</p>
<p>When <code class="language-text">iframeHeight</code> changes, we re-render the component.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> iframeHeight <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
          Let's embed this iframe below like
          it's part of our site! No double-scrolling
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
          <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iframe-container<span class="token punctuation">"</span></span>
          <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
            <span class="token operator">...</span><span class="token punctuation">(</span>iframeHeight
              <span class="token operator">?</span> <span class="token punctuation">{</span> height<span class="token punctuation">:</span> iframeHeight <span class="token punctuation">}</span>
              <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span>
            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>responsive-iframe<span class="token punctuation">"</span></span>
            <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              <span class="token operator">...</span><span class="token punctuation">(</span>iframeHeight
                <span class="token operator">?</span> <span class="token punctuation">{</span> height<span class="token punctuation">:</span> iframeHeight <span class="token punctuation">}</span>
                <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
              <span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
            <span class="token attr-name">srcdoc</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>iframeContent<span class="token punctuation">}</span></span>
          <span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
          Let's embed this iframe above like
          it's part of our site! No double-scrolling
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>I'm conditionally applying styles depending on whether we have a height to
work with or not. Note that inline styles like this give us a small performance hit.</p>
<p>Okay, if you were reading closely, you noticed that I glossed over
<code class="language-text">onElementHeightChange</code> and <code class="language-text">updateIframeHeight</code>. What's happening in those?</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token function-variable function">onElementHeightChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span>el<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> lastHeight <span class="token operator">=</span> el
      <span class="token punctuation">.</span>contentWindow
      <span class="token punctuation">.</span>document
      <span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      <span class="token punctuation">.</span>scrollHeight<span class="token punctuation">;</span>
    <span class="token keyword">let</span> newHeight<span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> bodies <span class="token operator">=</span> el
        <span class="token punctuation">.</span>contentWindow
        <span class="token punctuation">.</span>document
        <span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>bodies<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newHeight <span class="token operator">=</span> bodies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>scrollHeight<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lastHeight <span class="token operator">!==</span> newHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      lastHeight <span class="token operator">=</span> newHeight<span class="token punctuation">;</span>
      el<span class="token punctuation">.</span>onElementHeightChangeTimer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> <span class="token number">750</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>We compare the current height of the iframe, <code class="language-text">lastHeight</code>, with its <code class="language-text">newHeight</code>.
What's with the <code class="language-text">run</code> function in parentheses, you ask? It's a recursive function that we
call right away (<a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFE</a>).
Basically, we call the <code class="language-text">run</code> function, it gets the new height of the <code class="language-text">iframe</code>
and if that height is different from the previous one, we call the callback
function, which in our case is <code class="language-text">updateIframeHeight</code> and we'll discuss it right
after this one. On the last line, we do a setTimeout  which will call the <code class="language-text">run</code>
function again after a certain amount of milliseconds have passed. In practice,
this means that we created a loop that checks every so many milliseconds whether
the height of the iframe has changed, and if so, tells the component via
<code class="language-text">updateIframeHeight</code>.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token function-variable function">updateIframeHeight</span> <span class="token operator">=</span> <span class="token punctuation">(</span>newHeight<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> iframeHeight<span class="token punctuation">:</span> newHeight <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>Nothing crazy happening here, just updating the height in the component state...
and we're done!</p>
<h2>Conclusion</h2>
<p>We found a way to continuously have the body inside of an <code class="language-text">iframe</code> report its
height to a React component that contains the <code class="language-text">iframe</code>. This enabled us to use the
set the height of the containers around the <code class="language-text">iframe</code> and make it appear as if it
was just a normal <code class="language-text">div</code> that flows and resizes with the rest of the page.</p>
<p>If you have suggestions for better ways to include responsive <code class="language-text">iframes</code>, I'd love
to hear about them. Feel free to contact me!</p>
<h2>Tidbits</h2>
<p>Using the <code class="language-text">srcdoc</code> attribute on an <code class="language-text">iframe</code> is a fun way to render a full html
string converted to actual markup in a document. This is useful
if you're trying to display the html-version of an email or a scraped website
that you've saved to a text field in your database.</p>
<p>When you access the html or body inside of an iframe with the DOM API you may
notice that the <code class="language-text">scrollHeight</code> of the <code class="language-text">body</code> and that of the <code class="language-text">html</code> element are not the same.
This happens when tags such as <code class="language-text">body</code> or <code class="language-text">p</code> don't have their margins reset.
That's why you can see me adding <code class="language-text">style=&quot;margin:0;&quot;</code> to most of the elements in
<code class="language-text">iframeContent</code>.</p>
<p>Some people think that you need to <code class="language-text">clearTimeout</code> after <code class="language-text">setTimeout</code>. However,
that's only the case if you want to stop it before it runs.</p></div></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-writing-js","jsonName":"writing-responsive-same-domain-iframe-in-react-component-045","path":"/writing/responsive-same-domain-iframe-in-react-component/"};window.dataPath="559/path---writing-responsive-same-domain-iframe-in-react-component-045-348-HcXUmWgTjrOlJaBRDDSKMB1e0";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app.a2f933b7ab5f58f2ecfb.css","/app-61613bc7b701c1af75b4.js"],"component---src-templates-writing-js":["/component---src-templates-writing-js-44da32ae3be64ba2449b.js"],"component---src-pages-about-js":["/component---src-pages-about-js-82e7d5f1c25241ea38ef.js"],"component---src-pages-index-js":["/component---src-pages-index-js-af88c68e21ec58598644.js"],"component---src-pages-writing-index-js":["/component---src-pages-writing-index-js-fd13ef70c1d6888f14f7.js"],"pages-manifest":["/pages-manifest-ab3df57012008c8b31af.js"]};/*]]>*/</script><script src="/webpack-runtime-d9e994a04b02e9bd7f23.js" async=""></script><script src="/app-61613bc7b701c1af75b4.js" async=""></script><script src="/0-9ac6a65bd5e612ec4a71.js" async=""></script><script src="/component---src-templates-writing-js-44da32ae3be64ba2449b.js" async=""></script></body></html>